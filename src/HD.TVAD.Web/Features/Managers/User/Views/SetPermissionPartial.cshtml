@model HD.TVAD.Web.Features.Managers.User.Models.UserSetViewModel

@{
    var canSetPermission = User.IsInRole(HD.TVAD.Web.StartData.UserPermissions.Manager_User_SetPermission.ToString());
}

@(Html.DevExtreme().TreeList()
    .ID("treeSetPermission")
    .KeyExpr("id")
    .ParentIdExpr("parentId")
    .ShowBorders(true)
    .Selection(s => s.Mode(SelectionMode.Single))
    .RowAlternationEnabled(true)
    .HoverStateEnabled(true)
    .ColumnAutoWidth(true)
    .Sorting(s => s.Mode(GridSortingMode.Single))
    .NoDataText(Localizer["No group"].Value)
    .AllowColumnResizing(true)
    .ColumnResizingMode(ColumnResizingMode.NextColumn)
    .Height("100%")
    .AutoExpandAll(true)
    .Editing(e =>
    {
        e.Mode(DevExtreme.AspNet.Mvc.GridEditMode.Batch);

        e.AllowUpdating(canSetPermission);
    })
    .Columns(cols =>
    {
        cols.Add().DataField("check").Caption(Localizer["Check"].Value).DataType(GridColumnDataType.Boolean).Width(120);

        cols.Add().DataField("name").Caption(Localizer["Permission"].Value).AllowEditing(false);
    })
    .DataSource(ds => ds.WebApi().RouteName("managersApiRoute").Controller("UserWebAPI").LoadAction("GetPermissionsOfUser").LoadParams(new { userId = Model.userId }))
    .OnToolbarPreparing("userSetGroupOnToolbarPreparing")
    .OnEditorPrepared("userSetPermissionOnEditorPrepared")
)