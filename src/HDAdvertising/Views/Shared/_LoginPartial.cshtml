@using Microsoft.AspNetCore.Identity
@using HDAdvertising.Datas.Security

@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager

@if (SignInManager.IsSignedIn(User))
{
    <form asp-area="" asp-controller="Account" asp-action="Logout" method="post" id="logoutForm">
    </form>

    <div class="nav navbar-nav navbar-right">
        @(Html.DevExtreme().Menu()
            .ID("accountMenu")
            .Items(itms =>
            {
                itms.Add().Text(UserManager.GetUserName(User));
                itms.Add().Text("Đăng xuất");
            })
            .OnItemClick("onAccountMenuItemClick"))
    </div>
}
else
{
    <div class="nav navbar-nav navbar-right">
        @(Html.DevExtreme().Menu()
            .ID("accountMenu")
            .Items(itms =>
            {
                itms.Add().Text("Đăng nhập");
            })
            .OnItemClick("onAccountMenuItemClick"))
    </div>
}

<script>
    function onAccountMenuItemClick(data) {
        var menuItem = data.itemData;
        if (menuItem.text === "Đăng nhập")
            window.location.href = "/Account/Login";
        else if (menuItem.text === "Đăng xuất")
            document.getElementById("logoutForm").submit();
        else if (menuItem.text.startsWith("Xin chào"))
            window.location.href = "/Manage/Index";
    }
</script>
